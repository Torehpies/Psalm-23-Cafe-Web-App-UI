<div class="centered-toggle">
  <div class="toggle-container">
    <div class="toggle-option" [class.active]="isAddActive" (click)="toggleView()">ADD</div>
    <div class="toggle-option" [class.active]="!isAddActive" (click)="toggleView()">VIEW</div>
  </div>
  <button (click)="showAddForm = true" class="add-item-btn" *ngIf="isAddActive">+ Add Item</button>
</div>


<div class="table-section">
  <div class="filter-section" [ngClass]="{'hidden': isAddActive}">
    <div class="date-filter">
      <label for="fromDate">From:</label>
      <input type="date" id="fromDate" [(ngModel)]="fromDate" (change)="applyDateFilter()">
      <label for="toDate">To:</label>
      <input type="date" id="toDate" [(ngModel)]="toDate" (change)="applyDateFilter()">
    </div>
    <div class="download-section">
      <span class="download-title">Download:</span>
      <div class="download-buttons">
        <button>Custom Download</button>
        <button>All Time</button>
        <button>Month to Date</button>
        <button>Today</button>
      </div>
    </div>
  </div>
  <div class="scrapping-info">
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Item Name</th>
            <th>Quantity</th>
            <th>Scrapping Date</th>
            <th *ngIf="isAddActive">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let record of isAddActive ? newScrapData : filteredScrapData; let i = index">
            <td>{{ record.itemName }}</td>
            <td>{{ record.quantity }}</td>
            <td>{{ record.usedAt | date: 'mediumDate' }}</td>
            <td *ngIf="isAddActive">
              <button class="edit-btn" (click)="editItem(i)">Edit</button>
              <button class="delete-btn" (click)="deleteItem(i)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="submit" [ngClass]="{'hidden': !isAddActive}">
  <button (click)="submitScrapData()">Submit</button>
</div>

<app-add-scrap-modal [showAddForm]="showAddForm" [supplyData]="supplyData" [productData]="productData"
  (closeAddForm)="showAddForm = false" (addScrap)="onSubmit($event)">
</app-add-scrap-modal>

<app-edit-scrap-modal 
  [showEditForm]="showEditForm" 
  [supplyData]="supplyData" 
  [productData]="productData"
  [selectedItem]="selectedItem" 
  (closeEditForm)="showEditForm = false" 
  (updateScrap)="onUpdate($event)">
</app-edit-scrap-modal>

<app-delete-confirmation-modal [showDeleteConfirm]="showDeleteConfirm" (confirmDelete)="confirmDelete()"
  (cancelDelete)="cancelDelete()">
</app-delete-confirmation-modal>

<div *ngIf="showStatusModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50">
  <div class="bg-white p-6 rounded-lg shadow-lg">
    <p>{{ statusMessage }}</p>
  </div>
</div>